<ion-header>
  <ion-toolbar style="--background: #ffffff; --color: #000000;">
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/settings"></ion-back-button>
    </ion-buttons>
    <ion-title>Storage & Data</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding" style="--background: #f8f8f8;">
  <!-- Storage overview -->
  <ion-card>
    <ion-card-header>
      <ion-card-title>Storage Usage</ion-card-title>
      <ion-card-subtitle>{{ totalUsedHuman }}</ion-card-subtitle>
    </ion-card-header>

    <ion-card-content>
      <div class="progress-row">
        <ion-progress-bar [value]="storageFraction"></ion-progress-bar>
        <div class="progress-meta">
          <small>{{ usedMB }} MB used</small>
          <small>{{ totalMB }} MB total</small>
        </div>
      </div>

      <div class="actions">
        <ion-button fill="outline" (click)="analyzeStorage()">
          <ion-icon slot="start" name="search-outline"></ion-icon>
          Analyze
        </ion-button>
        <ion-button color="danger" (click)="clearCache()">
          <ion-icon slot="start" name="trash-outline"></ion-icon>
          Clear Cache
        </ion-button>
      </div>
    </ion-card-content>
  </ion-card>

  <!-- Network usage -->
  <ion-list lines="inset">
    <ion-list-header>
      <ion-label>Network Usage</ion-label>
    </ion-list-header>

    <ion-item>
      <ion-icon slot="start" name="cloud-upload-outline"></ion-icon>
      <ion-label>
        <h2>Data sent</h2>
        <p class="muted">{{ dataSentHuman }}</p>
      </ion-label>
      <ion-note slot="end">{{ dataSent }}</ion-note>
    </ion-item>

    <ion-item>
      <ion-icon slot="start" name="cloud-download-outline"></ion-icon>
      <ion-label>
        <h2>Data received</h2>
        <p class="muted">{{ dataReceivedHuman }}</p>
      </ion-label>
      <ion-note slot="end">{{ dataReceived }}</ion-note>
    </ion-item>

    <ion-item lines="none">
      <ion-button fill="clear" (click)="resetNetworkStats()">
        Reset statistics
      </ion-button>
    </ion-item>
  </ion-list>

  <!-- Manage storage -->
  <ion-list lines="inset">
    <ion-list-header>
      <ion-label>Manage</ion-label>
    </ion-list-header>

    <ion-item button detail (click)="openManageStorage()">
      <ion-icon slot="start" name="folder-open-outline"></ion-icon>
      <ion-label>
        <h2>Manage Storage</h2>
        <p>Review and delete large files, chats and media</p>
      </ion-label>
    </ion-item>

    <ion-item button detail (click)="openMediaAutoDownload()">
      <ion-icon slot="start" name="download-outline"></ion-icon>
      <ion-label>
        <h2>Media Auto-download</h2>
        <p>Control what downloads on mobile/Wi-Fi/roaming</p>
      </ion-label>
    </ion-item>
  </ion-list>
</ion-content>
